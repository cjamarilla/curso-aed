Accion Escenario1 Es

Ambiente
  Twitter= Registro
    Reg= Registro
    Region:N(4);
    SubRegion:N(3);
    Tipo:Caracter;
    Cuenta:N(13);
    FinRegistro
  Cantidad:N(8);
  FinRegistro

  Archivo: archivo de twitter ordenado por Region, SubRegion, Tipo, Cuenta;
  next: Twitter;
  Resg_Region:N(4);
  Resg_SubRegion:N(3);
  Resg_Tipo:Caracter;
  Resg_Cuenta:N(13);
  acum_total, cont_leve, cont_medio, cont_grave, cont_general:Enteros;

  Procedimiento Corte_Region Es
    Esc("Region: ",Resg_Region);
    Esc("SubRegion: ",Resg_SubRegion);
    Esc("Cuenta: ",Resg_Cuenta);
    cont_general := cont_general + cont_grave;
    cont_grave:= 0;
    Resg_Region: Twitter.Reg.Region;
  FinProcedimiento

  Procedimiento Corte_SubRegion Es
    Corte_Region();
    Esc("SubRegion: ",Resg_SubRegion);
    Esc("Cuenta: ",Resg_Cuenta);
    cont_grave:= cont_grave + cont_medio;
    cont_medio:=0;
    Resg_SubRegion:= Twitter.Reg.SubRegion;
  FinProcedimiento

  Procedimiento Corte_Cuenta Es
    Corte_SubRegion();
    Esc("Cuenta: ",Resg_Cuenta);
    cont_medio := cont_medio + cont_leve;
    cont_leve := 0;
    Resg_Cuenta := Twitter.Reg.Cuenta;
  FinProcedimiento

  Procedimiento Tratar_Corte Es
    Si(Twitter.Reg.Region <> Resg_Region) Entonces
      Corte_Region();
      Sino
        Si (Twitter.Reg.SubRegion <> Resg_SubRegion) Entonces
          Corte_SubRegion();
          Sino
            Si (Twitter.Reg.Cuenta <> Resg_Cuenta) Entonces
              Corte_Cuenta();
            FinSi
        FinSi
    FinSi
  FinProcedimiento

  Proceso
  Abrir E/(Archivo);
  Leer(Archivo,next);
  acum_total:=0;
  cont_leve:=0;
  cont_medio:=0;
  cont_grave:=0;
  cont_general:=0;
  Resg_Region:= Twitter.Reg.Region;
  Resg_SubRegion:= Twitter.Reg.SubRegion;
  Resg_Cuenta:= Twitter.Reg.Cuenta;

  Mientras NFDA (Archivo) Hacer
    Tratar_Corte();
    Si (Twitter.Reg.Tipo = "L") y (Twitter.Cantidad<15000) Entonces
      acum_total:= acum_total +1;
    FinSi
    Leer(Archivo,next);
    FinMientras

    Corte_Region();
    Esc("Total General es: ",cont_general);
    Esc("Region :", cont_grave);
    Esc("SubRegion: ",cont_medio);
    Esc("La cantidad de cuentas son : ",acum_total);

    Cerrar(Archivo);

    FinAccion
