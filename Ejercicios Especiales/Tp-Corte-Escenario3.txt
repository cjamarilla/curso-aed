Accion escenario3 Es 
  Ambiente
  Linkedin= Registro
    Clave= Registro
      Origen=N(6);
      Tipo:["1","2","3"];
      Antig:N(3);
      Cuenta:N(13);
    FinRegistro
    Vistas:N(8);
  FinRegistro

  Arch: archivo de Linkedin ordando por Clave;
  Reg:Linkedin;
  Resg_Origen:N(6);
  Resg_Tipo:["1","2","3"];
  Resg_Antig:N(3);
  Resg_Cuenta:N(13);
  Acum_Vistas, Cont_General, Cont_Origen, Cont_Tipo, Cont_Antig: Enteros;

  Procedimiento Corte_Origen Es
    Esc("Origen: ",Resg_Origen);
    Esc("Tipo: ",Resg_Tipo);
    Esc("Antiguedad: ",Resg_Antig);
    Cont_General := Cont_General + Cont_Origen;
    Cont_Origen := 0;
    Resg_Origen := Linkedin.Clave.Origen;
  FinProcedimiento

  Procedimiento Corte_Tipo Es
    Corte_Origen();
    Esc("Tipo: ",Resg_Tipo);
    Esc("Antiguedad: ",Resg_Antig);
    Cont_Origen := Cont_Origen + Cont_Tipo;
    Cont_Tipo := 0;
    Resg_Tipo := Linkedin.Clave.Tipo;
  FinProcedimiento

  Procedimiento Corte_Antiguedad Es
    Corte_Tipo();
    Esc("Antiguedad: ",Resg_Antig);
    Cont_Tipo := Cont_Tipo + Cont_Antig;
    Cont_Antig := 0;
    Resg_Antig := Linkedin.Clave.Antig;
  FinProcedimiento

  Procedimiento Tratar_Corte Es
    Si (Linkedin.Clave.Origen <> Resg_Origen) Entonces
      Corte_Origen();
      Sino
        Si (Linkedin.Clave.Tipo <> Resg_Tipo) Entonces
          Corte_Tipo();
          Sino
            Si (Linkedin.Clave.Antig <> Resg_Antig) Entonces
              Corte_Antiguedad();
            FinSi
        FinSi
    FinSi
  FinProcedimiento

  Proceso
  Abrir E/(Arch);
  Leer(Arch,Reg);
  Cont_Antig:=0;
  Cont_General:=0;
  Cont_Origen:=0;
  Cont_Tipo:=0;
  Acum_Vistas:=0;
  Resg_Origen:= Linkedin.Clave.Origen;
  Resg_Tipo:= Linkedin.Clave.Tipo;
  Resg_Antig:= Linkedin.Clave.Antig;

  Mientras NFDA (Arch) Hacer
    Tratar_Corte();
    Si (Linkedin.Vistas > 1000) y (Linkedin.Clave.Antig < 5) Entonces
      Acum_Vistas := Acum_Vistas + 1;
    FinSi
    Leer(Arch,Reg);
  FinMientras

  Corte_Origen();
  Esc("Total General es: ",Cont_General);
  Esc("Origen es: ",Cont_Origen);
  Esc("Tipo es: ",Cont_Tipo);
  Esc("La Antiguedad es: ",Cont_Antig);
  Esc("La cantidad de cuentas con vistas mayores a 1000 es: ",Acum_Vistas);

  Cerrar(Arch);

FinAccion
